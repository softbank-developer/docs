# MAIL機能 概要

## 1. 対象メール/テキストの指定

- ユーザーの指定した検索構文（Gmail標準のもの）でメールを絞り込みできる

!!! Info "Gmail で使用できる検索演算子"
	[https://support.google.com/mail/answer/7190?hl=ja](https://support.google.com/mail/answer/7190?hl=ja)

!!! Warning "変更"
     最大取得スレッド数を設定可能にする(ストーリー #6751)
    + 最大取得スレッド数の上限は500にする(ストーリー #6810)

!!! Note "取得基準日の算出方法"
    設定シート上に、取得基準日を算出するための、「過去分取得日数」フィールドを追加する (ストーリー #6770)
    過去分取得日数が１以上の場合は（本日 - 過去分取得日数）を基準日とする。ex. 1の場合は「昨日」
    過去分取得日数が０の場合は、データシート上の受信日時の中から最新の日付を基準日とする。
    （ただし、対象が存在しなかった場合は「本日」を基準日とする）
    取得基準日の時刻は00:00:00にリセットする。


- 処理対象として「件名」「本文」「両方」を指定できる。

!!! Warning "変更"
    ユーザー向けに表示するラベルは以下を使用する(ストーリー #6630)

    + 件名のみ
    + 本文のみ
    + 件名・本文両方

- 本文のうち、Watsonへ投入「しない」箇所を正規表現で不特定数、指定できる

- 前回取得時以前のメールは無視することができる。（時間間隔のトリガを設定することで、新着メールを継続的に取り込める。）

!!! Warning "追加"
    同一かどうか識別するために、取得する項目にIDを追加する


- 各種パラメータの設定が、スプレッドシートで実施できる

---

## 2. スプレッドシートへの記録

- メールの「件名」「宛先」「本文」と「機能1で指定したテキスト」をユーザ指定列の、ユーザ指定行以下にユーザー指定の並び方（newest first or oldest first）で記録できる

!!! Warning "追加"
	メールの取得項目に下記を追加(ストーリー #6752,ストーリー #6769)

    + 受信日時
    + From
    + Cc
    + Bcc

!!! missing "変更"
	要件2-2との両立が難しいため、並び方の指定は可能にせず、常に最終行に追記する


- テキストが記録される列・行以外の情報は保持される（行が挿入される場合はスライドする）

- 各種パラメータの設定が、スプレッドシート上で実施できる

